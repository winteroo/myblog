<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>bind函数 | 进击的小超人</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/myblog/favicon.ico">
    <meta name="description" content="JavaScript、Nodejs、Vue、React、Algorithm">
    <link rel="preload" href="/myblog/assets/css/0.styles.c79f7989.css" as="style"><link rel="preload" href="/myblog/assets/js/app.453e8642.js" as="script"><link rel="preload" href="/myblog/assets/js/2.3c4aeba2.js" as="script"><link rel="preload" href="/myblog/assets/js/14.ceff9c58.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.83af3176.js"><link rel="prefetch" href="/myblog/assets/js/11.7b4131bf.js"><link rel="prefetch" href="/myblog/assets/js/12.1280369e.js"><link rel="prefetch" href="/myblog/assets/js/13.499720fd.js"><link rel="prefetch" href="/myblog/assets/js/15.a178b9b3.js"><link rel="prefetch" href="/myblog/assets/js/16.96ad8d32.js"><link rel="prefetch" href="/myblog/assets/js/17.b13049f8.js"><link rel="prefetch" href="/myblog/assets/js/18.571b422e.js"><link rel="prefetch" href="/myblog/assets/js/19.df3fb1dc.js"><link rel="prefetch" href="/myblog/assets/js/20.25716f95.js"><link rel="prefetch" href="/myblog/assets/js/21.8dae54ad.js"><link rel="prefetch" href="/myblog/assets/js/22.c544fded.js"><link rel="prefetch" href="/myblog/assets/js/23.d37bd82e.js"><link rel="prefetch" href="/myblog/assets/js/24.5b7d1238.js"><link rel="prefetch" href="/myblog/assets/js/25.792020e0.js"><link rel="prefetch" href="/myblog/assets/js/26.80ec25ce.js"><link rel="prefetch" href="/myblog/assets/js/27.862435bb.js"><link rel="prefetch" href="/myblog/assets/js/28.164ce7cd.js"><link rel="prefetch" href="/myblog/assets/js/29.36b12874.js"><link rel="prefetch" href="/myblog/assets/js/3.f72e40b9.js"><link rel="prefetch" href="/myblog/assets/js/30.9bba5134.js"><link rel="prefetch" href="/myblog/assets/js/31.ba904784.js"><link rel="prefetch" href="/myblog/assets/js/32.b2fcd531.js"><link rel="prefetch" href="/myblog/assets/js/33.260b21d6.js"><link rel="prefetch" href="/myblog/assets/js/34.8a3bf1a0.js"><link rel="prefetch" href="/myblog/assets/js/35.87417bdc.js"><link rel="prefetch" href="/myblog/assets/js/36.c1d563a9.js"><link rel="prefetch" href="/myblog/assets/js/37.cb0febf3.js"><link rel="prefetch" href="/myblog/assets/js/38.eb1e9d20.js"><link rel="prefetch" href="/myblog/assets/js/39.9d71f480.js"><link rel="prefetch" href="/myblog/assets/js/4.4fb8c55c.js"><link rel="prefetch" href="/myblog/assets/js/40.90e61611.js"><link rel="prefetch" href="/myblog/assets/js/41.7a782b12.js"><link rel="prefetch" href="/myblog/assets/js/42.0669ba5f.js"><link rel="prefetch" href="/myblog/assets/js/43.3c747861.js"><link rel="prefetch" href="/myblog/assets/js/44.332bf3e1.js"><link rel="prefetch" href="/myblog/assets/js/45.79910041.js"><link rel="prefetch" href="/myblog/assets/js/46.758854c4.js"><link rel="prefetch" href="/myblog/assets/js/47.bed2c9af.js"><link rel="prefetch" href="/myblog/assets/js/48.65c68e24.js"><link rel="prefetch" href="/myblog/assets/js/49.bd028428.js"><link rel="prefetch" href="/myblog/assets/js/5.3f5e3e69.js"><link rel="prefetch" href="/myblog/assets/js/50.1ec82edf.js"><link rel="prefetch" href="/myblog/assets/js/51.a542d922.js"><link rel="prefetch" href="/myblog/assets/js/52.a93be0a3.js"><link rel="prefetch" href="/myblog/assets/js/53.e9d14908.js"><link rel="prefetch" href="/myblog/assets/js/54.60ab3fe8.js"><link rel="prefetch" href="/myblog/assets/js/55.acf67c40.js"><link rel="prefetch" href="/myblog/assets/js/56.7d3ada07.js"><link rel="prefetch" href="/myblog/assets/js/57.bc391c0b.js"><link rel="prefetch" href="/myblog/assets/js/58.b8deb182.js"><link rel="prefetch" href="/myblog/assets/js/59.518297b6.js"><link rel="prefetch" href="/myblog/assets/js/6.d15901fc.js"><link rel="prefetch" href="/myblog/assets/js/60.a9af2f18.js"><link rel="prefetch" href="/myblog/assets/js/61.3d32dca1.js"><link rel="prefetch" href="/myblog/assets/js/62.efef438d.js"><link rel="prefetch" href="/myblog/assets/js/63.7a5a2d07.js"><link rel="prefetch" href="/myblog/assets/js/64.95ce0761.js"><link rel="prefetch" href="/myblog/assets/js/65.c5797645.js"><link rel="prefetch" href="/myblog/assets/js/7.7f90d6cb.js"><link rel="prefetch" href="/myblog/assets/js/8.a6e56e5f.js"><link rel="prefetch" href="/myblog/assets/js/9.c4f0a606.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.c79f7989.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><img src="/myblog/home.jpg" alt="进击的小超人" class="logo"> <span class="site-name can-hide">进击的小超人</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/myblog/Front/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/Backend/Nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/myblog/Backend/Java/" class="nav-link">
  Java
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/Algorithm/" class="nav-link">
  算法与数据结构
</a></div><div class="nav-item"><a href="/myblog/Life/" class="nav-link">
  杂谈
</a></div><div class="nav-item"><a href="/myblog/About/" class="nav-link">
  关于作者
</a></div><div class="nav-item"><a href="https://github.com/winteroo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/myblog/Front/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/Backend/Nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/myblog/Backend/Java/" class="nav-link">
  Java
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/Algorithm/" class="nav-link">
  算法与数据结构
</a></div><div class="nav-item"><a href="/myblog/Life/" class="nav-link">
  杂谈
</a></div><div class="nav-item"><a href="/myblog/About/" class="nav-link">
  关于作者
</a></div><div class="nav-item"><a href="https://github.com/winteroo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>概述</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/Front/JS/001positionOperation.html" class="sidebar-link">JS位运算</a></li><li><a href="/myblog/Front/JS/002packing.html" class="sidebar-link">JS装箱和拆箱</a></li><li><a href="/myblog/Front/JS/003stringCut.html" class="sidebar-link">JS字符串截取</a></li><li><a href="/myblog/Front/JS/004eventLoop.html" class="sidebar-link">JS事件循环(Event Loop)</a></li><li><a href="/myblog/Front/JS/005closure.html" class="sidebar-link">闭包</a></li><li><a href="/myblog/Front/JS/006prototypeChain.html" class="sidebar-link">原型和原型链</a></li><li><a href="/myblog/Front/JS/008extends.html" class="sidebar-link">JS的继承</a></li><li><a href="/myblog/Front/JS/007json.html" class="sidebar-link">JSON操作方法</a></li><li><a href="/myblog/Front/JS/009new.html" class="sidebar-link">new运算符</a></li><li><a href="/myblog/Front/JS/010bind.html" class="active sidebar-link">bind函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/Front/JS/010bind.html#bind函数的特性" class="sidebar-link">bind函数的特性</a></li><li class="sidebar-sub-header"><a href="/myblog/Front/JS/010bind.html#实现bind函数" class="sidebar-link">实现bind函数</a></li><li class="sidebar-sub-header"><a href="/myblog/Front/JS/010bind.html#官方bind函数实现" class="sidebar-link">官方bind函数实现</a></li></ul></li><li><a href="/myblog/Front/JS/011flatarray.html" class="sidebar-link">数组扁平化</a></li><li><a href="/myblog/Front/JS/012regular.html" class="sidebar-link">正则表达式</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="bind函数"><a href="#bind函数" class="header-anchor">#</a> bind函数</h1> <p>bind函数是非常常见的绑定函数作用域的方法，那bind都有哪些特性，又是如何实现的呢？下面我们就来探索一下。</p> <h2 id="bind函数的特性"><a href="#bind函数的特性" class="header-anchor">#</a> bind函数的特性</h2> <p>测试函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myTest</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
myTest<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">walk</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'walk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="为函数绑定作用域"><a href="#为函数绑定作用域" class="header-anchor">#</a> 为函数绑定作用域</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里，我们为函数<code>myTest</code>绑定作用域为<code>obj</code>，所以输出的<code>this.a</code>是<code>obj.a</code>为30；</p> <h3 id="函数柯里化"><a href="#函数柯里化" class="header-anchor">#</a> 函数柯里化</h3> <p>修改源函数为接受一个参数的函数，并执行打印。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myTest</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">c</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30 10</span>

<span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30 10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>bind绑定之后的函数，具备了函数柯里化的特性。</p> <h3 id="对new无效"><a href="#对new无效" class="header-anchor">#</a> 对new无效</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30</span>

<span class="token keyword">let</span> cc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
cc<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// walk</span>

<span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
d<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// walk</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>上面的代码结果，我们发现，<code>new</code>操作符修饰后的绑定函数和未绑定函数的表现是一样的，由此可以得出
<code>bind</code>函数对<code>new</code>操作是无效的。</p> <h2 id="实现bind函数"><a href="#实现bind函数" class="header-anchor">#</a> 实现bind函数</h2> <ul><li><code>bind</code>方法是函数方法特有的属性，所以<code>bind</code>是定义在<code>Function.prototype</code>上的；</li> <li><code>bind</code>方法返回的是一个函数；</li> <li><code>bind</code>方法的函数参数是可传递的；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 数组方法</span>
  <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">;</span>
  
  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
  <span class="token comment">// 绑定的作用域</span>
  <span class="token keyword">let</span> context <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 剩余参数</span>
  <span class="token keyword">let</span> restArgs <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token function-variable function">fun</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 组合bing参数</span>
    <span class="token keyword">let</span> allArgs <span class="token operator">=</span> restArgs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 返回原函数在context作用域下的执行结果</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> allArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> fun<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>执行上述的函数测试，我们可以发现，我们实现的<code>bind</code>函数对<code>new</code>操作符是有效的，但是无法访问原函数
原型链上的属性和方法。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> cc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 30</span>
cc<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="data:image/png;base64,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" alt="bind">
所以，我们需要对<code>new</code>操作符做特殊处理:</p> <ul><li><strong>1、在调用函数执行时，检查是否是<code>new</code>操作符创造的实例，如果是，则将作用域设置为<code>this</code></strong></li> <li><strong>2、修正返回函数的原型为原函数逇原型</strong></li></ul> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">;</span>

  <span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>

  <span class="token keyword">let</span> context <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> restArgs <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token function-variable function">fun</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> allArgs <span class="token operator">=</span> restArgs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">fun</span> <span class="token operator">?</span> <span class="token keyword">this</span> <span class="token operator">:</span> context<span class="token punctuation">,</span> allArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  fun<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> fun<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>测试：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">myTest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> cc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cc<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="data:image/png;base64,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mMqpt8wmlWxVgEppKmPbF4YDAMxi152SAwDYaQoTAECFwgQAUKEwAQBUKEwAABUKEwBAhcIEAFChMAEAVChMAAAV+9bW1hoRERERGR2FSURERKQSp+QAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgQmECAKhQmC47efJkc/To0WZ1dXVjyXSyffZz+PDhzWTfbevr683x48cH686cObOx9OqY1+sGgL1OYbpsHsWhlKWUoZSiURQmANh9FKbL5lEcnnrqqUEJys/dQmECgPEoTJfNozhktuj2229vLly4sLFk8SlMADCehS1M+SWeX+b5pd6WQpJi0j6dlTE5zbWysjLYZtT1Q0WWlzElfcWhzBptNaaoFabyetr765uNKq8v67LPMnbUvsfdb4z7ugGAYXumMJUCUMpC37hR+8z9bnEoZaVdPjKuXVzahaYvo0pO9pn1fcWmPO+sb18P1fccy9j26yn7nvZ1AwBX2lOFqV1AysXVtdIR3eXlsduPEaOWR5aNKkhd4xSm9vOOvm3yvLvjort83NcNAPTbM4Wp+4u/W5jK/e7+ort9Sklf+enus23ehalbyrrblP8+tfI2yesGAPotTWEatb/obp99p5yMyiIUpjKu/bzaKc9lktcNAPRTmC7rbp9SMm75KXa6MJXX0x3XNcnrBgD67brClIKQ4jBpYereL0pBaW8/qrRsJWN3sjCNej1dk7xuAKDfwham6BahUpamKUzRLR0pDdnuxIkTV2yffY4qNX12ujBFWdYtlV3dbbd63QDAlRa6MJXSk1/2SW6X71qapjBFu3SVbbKsrziUotFNu7QUtcI0al9Je7tJClPkOee5d/fZLVGTvG4AYNhCFyYAgEWgMAEAVChMAAAVChMAQIXCBABQoTABAFQoTAAAFQoTAEDFvrW1tUZERERERkdhEhEREanEKTkAgAqFCQCgQmECAKhQmAAAKhQmAIAKhQkAoEJhAgCoUJgAACqWqjCtrq42Bw4caK655prNnD17dmPt362vrzcHDx4cJLcBgOW2tDNMKUoKEwAwDoVJYQIAKhQmhQkAqFjIwlSuNTp16tTGkmF968+fP9/s379/89qkZNT2MU1hOnLkyGCbPHaeAwCwHBa6MKWg9CnlqBSi3D906NBQucm6rUrTpIWplKWtShgAsDctZGEqhaUUpu6MUilMfWWn6O6ja5LCVMrSVo8HAOxdC3sNU0pKKSyl3LTvpzClOI3SLT1d4xamzFzVHgsA2NsWtjBlNqlcK5Tbx44da66//vpBcWmvK7IsBaibWQpT2YfCBADLbWELU5lFOnfu3GCWJz9TYlKMknYR6jtl1p4lmrYwJSsrK4Ny1i1oAMDyWNjClBmda6+9tjl9+vTmBd2lKOV+uTZpVDEatbwYtzDldrmGSmkCgOW0sIWplJSUmlKOUqIy65RlKU9Ryk37tFl723kUpiiPrTQBwPJZ2MJUSku71PQti3ZBSkp5al84HqUk9aVduPoKU5Tt22MBgL1vYQsTAMCiUJgAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgYt/a2lojIiIiIqOjMImIiIhU4pQcAECFwgQAUKEwAQBUKEwAABUKEwBAhcIEAFChMAEAVChMAAAVChMAQIXCdNnJkyebo0ePNqurqxtLppPts5/Dhw9vJvtuW19fb44fPz5Yd+bMmY2lV8e8XjcA7HUK02XzKA6lLKUMpRSNojABwO6jMF02j+Lw1FNPDUpQfu4WChMAjEdhumwexSGzRbfffntz4cKFjSWLT2ECgPEsbGHKL/H8Ms8v9bYUkhST9umsjMlprpWVlcE2o64fKrK8jCnpKw5l1mirMUWtMJXX095f32xUeX1Zl32WsaP2Pe5+Y9zXDQAM2zOFqRSAUhb6xo3aZ+53i0MpK+3ykXHt4tIuNH0ZVXKyz6zvKzbleWd9+3qovudYxrZfT9n3tK8bALjSnipM7QJSLq6ulY7oLi+P3X6MGLU8smxUQeoapzC1n3f0bZPn3R0X3eXjvm4AoN+eKUzdX/zdwlTud/cX3e1TSvrKT3efbfMuTN1S1t2m/PeplbdJXjcA0G9pCtOo/UV3++w75WRUFqEwlXHt59VOeS6TvG4AoJ/CdFl3+5SScctPsdOFqbye7riuSV43ANBv1xWmFIQUh0kLU/d+UQpKe/tRpWUrGbuThWnU6+ma5HUDAP0WtjBFtwiVsjRNYYpu6UhpyHYnTpy4Yvvsc1Sp6bPThSnKsm6p7Opuu9XrBgCutNCFqZSe/LJPcrt819I0hSnapatsk2V9xaEUjW7apaWoFaZR+0ra201SmCLPOc+9u89uiZrkdQMAwxa6MAEALAKFCQCgQmECAKhQmAAAKhQmAIAKhQkAoEJhAgCoUJgAACr2ra2tNSIiIiIyOgqTiIiISCVOyQEAVChMAAAVChMAQIXCBABQoTABAFQoTAAAFQoTAECFwgQAULFUhWl1dbU5cOBAc80112zm7NmzG2v/bn19vTl48OAguQ0ALLelnWFKUVKYAIBxKEwKEwBQoTApTABAxUIWpnKt0alTpzaWDOtbf/78+Wb//v2b1yYlo7aPaQrTkSNHBtvksfMcAIDlsNCFKQWlTylHpRDl/qFDh4bKTdZtVZomLUylLG1VwgCAvWkhC1MpLKUwdWeUSmHqKztFdx9dkxSmUpa2ejwAYO9a2GuYUlJKYSnlpn0/hSnFaZRu6ekatzBl5qr2WADA3rawhSmzSeVaodw+duxYc/311w+KS3tdkWUpQN3MUpjKPhQmAFhuC1uYyizSuXPnBrM8+ZkSk2KUtItQ3ymz9izRtIUpWVlZGZSzbkEDAJbHwhamzOhce+21zenTpzcv6C5FKffLtUmjitGo5cW4hSm3yzVUShMALKeFLUylpKTUlHKUEpVZpyxLeYpSbtqnzdrbzqMwRXlspQkAls/CFqZSWtqlpm9ZtAtSUspT+8LxKCWpL+3C1VeYomzfHgsA7H0LW5gAABaFwgQAUKEwAQBUKEwAABUKEwBAhcIEAFCxb21trRERERGR0VGYRERERCpxSg4AoEJhAgCoUJgAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgYubCtP6npnn19Tc37gEA7D0zFabX/vxmc99jrzd3PfJac3FdaQIA9qaZCtP/PfPn5l9vvdS85ZaLzQ33v9q8/helCQDYe2YqTJfW32xufnB9UJj+6aaLzX/d+2rz4tobjdoEAOwlM1/D9NLFN5o7Hn6t2X/rpeafD11sDv73q81zL/y1eUNrAgD2iJkLU6z+8c3m2P++PihM/3LLpeY/T7zaXHjxrxtrAQB2t7kUpsgF4A888afmX26+OChOB+56pTn/4hsbawEAdq+5FqZTZ//UvOXwRmG681Jz/gWFCQDY/ZySAwCocNE3AEDFTIXJ1woAAMtgpsLkiysBgGUwU2HyT6MAAMtg5muY/OO7AMBeN3NhAgDY6xQmAIAKhQkAoEJhAgCoUJgAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgQmECAKhQmAAAKhQmAIAKhQkAoEJhAgCoUJgAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgQmECAKhQmAAAKhQmAIAKhQkAoEJhAgCoUJgAACoUJgCACoUJAKBCYQIAqFCYAAAqFCYAgAqFCQCgQmECANhS0/w/qy4IezVWnPUAAAAASUVORK5CYII=" alt="bind"></p> <h2 id="官方bind函数实现"><a href="#官方bind函数实现" class="header-anchor">#</a> 官方bind函数实现</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token comment">/* eslint no-invalid-this: 1 */</span>

<span class="token keyword">var</span> <span class="token constant">ERROR_MESSAGE</span> <span class="token operator">=</span> <span class="token string">'Function.prototype.bind called on incompatible '</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">;</span>
<span class="token keyword">var</span> toStr <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
<span class="token keyword">var</span> funcType <span class="token operator">=</span> <span class="token string">'[object Function]'</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">that</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token function">toStr</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">!==</span> funcType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token constant">ERROR_MESSAGE</span> <span class="token operator">+</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> bound<span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">binder</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">bound</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>
                <span class="token keyword">this</span><span class="token punctuation">,</span>
                args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Object</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">===</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>
                that<span class="token punctuation">,</span>
                args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> boundLength <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>length <span class="token operator">-</span> args<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> boundArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> boundLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        boundArgs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'$'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    bound <span class="token operator">=</span> <span class="token function">Function</span><span class="token punctuation">(</span><span class="token string">'binder'</span><span class="token punctuation">,</span> <span class="token string">'return function ('</span> <span class="token operator">+</span> boundArgs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'){ return binder.apply(this,arguments); }'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>binder<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token function-variable function">Empty</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">Empty</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> target<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
        bound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Empty</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> bound<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/25/2020, 5:50:59 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/myblog/Front/JS/009new.html" class="prev">
        new运算符
      </a></span> <span class="next"><a href="/myblog/Front/JS/011flatarray.html">
        数组扁平化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div></div></div></div>
    <script src="/myblog/assets/js/app.453e8642.js" defer></script><script src="/myblog/assets/js/2.3c4aeba2.js" defer></script><script src="/myblog/assets/js/14.ceff9c58.js" defer></script>
  </body>
</html>
